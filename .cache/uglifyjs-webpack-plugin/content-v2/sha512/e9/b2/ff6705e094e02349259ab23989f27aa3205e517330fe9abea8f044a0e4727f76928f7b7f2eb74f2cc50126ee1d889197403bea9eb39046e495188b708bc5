{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{\"106\":function(e,t,n){\"use strict\";var a=n(0),o=n(1),r=n(421),i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var c=function(e){function Navigation(){var e,t,n;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,Navigation);for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];return t=n=_possibleConstructorReturn(this,(e=Navigation.__proto__||Object.getPrototypeOf(Navigation)).call.apply(e,[this].concat(r))),n.handleNavigateTo=function(){o.a.navigateTo({\"url\":n.props.url})},n.config={\"navigationBarTitleText\":\"首页\",\"usingComponents\":{}},_possibleConstructorReturn(n,t)}return function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{\"constructor\":{\"value\":e,\"enumerable\":!1,\"writable\":!0,\"configurable\":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Navigation,o[\"a\"].Component),i(Navigation,[{\"key\":\"componentWillMount\",\"value\":function componentWillMount(){}},{\"key\":\"componentDidMount\",\"value\":function componentDidMount(){}},{\"key\":\"componentWillUnmount\",\"value\":function componentWillUnmount(){}},{\"key\":\"componentDidShow\",\"value\":function componentDidShow(){}},{\"key\":\"componentDidHide\",\"value\":function componentDidHide(){}},{\"key\":\"render\",\"value\":function render(){return a.l.createElement(r.a,{\"className\":\"navigator\",\"onClick\":this.handleNavigateTo},this.props.children)}}]),Navigation}();t.a=c},\"22\":function(e,t,n){\"use strict\";n.r(t),n.d(t,\"default\",function(){return E});var a=n(0),o=n(425),r=n(1),i=n(120),c=n(421),s=n(422),l=n(179),u=n(206),m=n(105),p=n(115),d=n(121),f=n(94),h=n(93),g=(n(96),n(258),n(106)),y=n(150),b=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,\"value\"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var E=function(e){function Cart(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,Cart);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(Cart.__proto__||Object.getPrototypeOf(Cart)).call(this,e));return t.findTarget=function(e,n){var a={},o={};return t.state.storeList.forEach(function(t){t.storeID===e.storeID&&(a=t).proList.forEach(function(e){e.id===n.id&&(o=e)})}),{\"targetStore\":a,\"targetPro\":o}},t.handleCheckChange=function(e){console.log(222);var n=e.detail.value,a=!0;t.state.storeList.forEach(function(e){e.proList.forEach(function(e){n.includes(JSON.stringify(e.id))?e.checked=!0:(e.checked=!1,a=!1)})}),t.setState({\"hasCheckAll\":!1,\"checkAll\":a},function(){t.setState({\"hasCheckAll\":!0})}),t.totalAmount()},t.checkAll=function(){!1===t.state.checkAll?(t.setState({\"checkAll\":!0}),t.state.storeList.forEach(function(e){e.proList.forEach(function(e){e.isShelfUp&&!e.expired&&(e.checked=!0)})})):(t.setState({\"checkAll\":!1}),t.state.storeList.forEach(function(e){e.proList.forEach(function(e){e.checked=!1})})),t.setState({\"proList\":t.state.proList});var e=t.state.storeList;t.setState({\"storeList\":[]},function(){t.setState({\"storeList\":e})}),t.totalAmount()},t.checkStore=function(e){e.checked=!e.checked,!0===e.checked?e.proList.forEach(function(e){e.checked=!0}):e.proList.forEach(function(e){e.checked=!1});var n=t.state.storeList.some(function(e){return!e.checked});t.setState({\"checkAll\":!n}),t.totalAmount()},t.checkItem=function(e,n){e.checked=!e.checked;var a=n.proList.some(function(e){return!e.checked});n.checked=!a;t.state.storeList.some(function(e){return!e.checked});t.totalAmount()},t.amountRaise=function(e,n){var a=t.findTarget(e,n).targetPro;a.amount_amount++,a.amount_amount>99?a.amount_amount=99:a.amount_amount<1&&(a.amount_amount=1),a.amount=a.singlePrice*a.amount_amount,t.shoppingCartUpdate(n,a.amount_amount),t.totalAmount()},t.amountReduce=function(e,n){var a=t.findTarget(e,n).targetPro;a.amount_amount--,a.amount_amount>99?a.amount_amount=99:a.amount_amount<1&&(a.amount_amount=1),a.amount=a.singlePrice*a.amount_amount,t.shoppingCartUpdate(n,a.amount_amount),t.totalAmount()},t.inputNumber=function(e,n,a){var o=t.findTarget(n,a).targetPro;o.amount_amount=e.detail.value,o.amount_amount=o.amount_amount.replace(/\\D/g,\"\"),o.amount_amount>99?o.amount_amount=99:o.amount_amount<1&&e.detail.value&&(o.amount_amount=1),o.amount=o.singlePrice*o.amount_amount,t.shoppingCartUpdate(a,o.amount_amount),t.totalAmount()},t.inputComplete=function(e,n,a){var o=t.findTarget(n,a).targetPro;o.amount_amount=e.detail.value,t.setState({},function(){o.amount_amount=o.amount_amount.replace(/\\D/g,\"\").replace(/^[0]+/,\"\"),o.amount_amount>99?o.amount_amount=99:o.amount_amount<1&&(o.amount_amount=1),o.amount=o.singlePrice*o.amount_amount,t.shoppingCartUpdate(a,o.amount_amount),t.totalAmount()})},t.shoppingCartUpdate=function(e,t){var n={\"id\":e.id,\"itemId\":e.proID,\"itemNum\":t};Object(h.a)(f.a.shoppingCartUpdate,n)},t.getCart=function(){Object(h.a)(f.a.getCart,{\"current\":1,\"len\":10}).then(function(e){e.data.data.length>0?t.setState({\"isEmpty\":!1,\"storeList\":[].concat(function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.data.data.map(function(e){return{\"storeID\":e.shopId,\"storeName\":e.shopName,\"checked\":!0,\"proList\":e.detailVOList.map(function(e){return{\"proID\":e.itemId,\"id\":e.id,\"img\":e.image,\"proInfo\":e.itemName,\"amount_amount\":e.itemNum,\"type\":e.className,\"subType\":e.specName,\"originPrice\":e.originPrice.toFixed(2),\"singlePrice\":e.price.toFixed(2),\"amount\":e.itemNum*e.price,\"discount\":0,\"isFavourite\":e.isFavourite,\"isShelfUp\":e.isShelfUp,\"expired\":e.expired,\"checked\":!(!e.isShelfUp||e.expired)}})}})))},function(){console.log(t.state.storeList,\"storeList\"),t.totalAmount()}):t.setState({\"storeList\":[],\"isEmpty\":!0},function(){t.totalAmount()})})},t.totalAmount=function(){var e=0;t.state.storeList.forEach(function(t){t.proList.forEach(function(t){t.checked&&(e+=t.amount-t.discount)})}),t.setState({\"totalAmount\":parseFloat(e.toFixed(2))})},t.countStore=function(){for(var e=0,n=t.state.storeList,a=0;a<n.length;a++){for(var o=n[a],r=0;r<o.proList.length;r++){var i=o.proList[r];if(o.includeChecked=!1,!0===i.checked){o.includeChecked=!0;break}}!0===o.includeChecked&&e++}return e},t.deleteSingleConfirm=function(e,n){var a=[n.id],r=function deleteSingleRequest(a){Object(h.a)(f.a.deleteProduction,a).then(function(a){0===a.data.code&&(Object(o.d)({\"title\":\"删除成功\",\"icon\":\"success\",\"duration\":2e3}),function deleteSingleLocal(){var a=0,o={};if(t.state.storeList.forEach(function(t){t.storeID===e.storeID&&(o=t).proList.forEach(function(e){e.id===n.id&&(a=o.proList.indexOf(e))})}),o.proList.splice(a,1),0===o.proList.length){var r=t.state.storeList.indexOf(o);t.state.storeList.splice(r,1)}0===t.state.storeList.length&&t.setState({\"isEmpty\":!0}),t.totalAmount()}())}).catch(function(e){console.log(\"接口异常 - 删除商品：\",e)})};Object(o.c)({\"title\":\"删除商品\",\"content\":\"是否删除该商品？\",\"success\":function success(e){e.confirm&&r(a)}})},t.handleConcern=function(e,n){var a={\"itemId\":n.proID};Object(h.a)(f.a.userAtItemAdd,a).then(function(a){0===a.data.code&&(Object(o.d)({\"title\":\"收藏成功\",\"icon\":\"success\",\"duration\":2e3}),t.state.storeList.forEach(function(t){t.storeID===e.storeID&&t.proList.forEach(function(e){e.proID===n.proID&&(e.isFavourite=!0)})}),t.setState({}))})},t.handleCancelConcern=function(e,n){var a={\"itemIdList\":[n.proID]};Object(h.a)(f.a.userAtItemRemoveByIds,a).then(function(a){0===a.data.code?(Object(o.d)({\"title\":\"取消收藏成功\"}),t.state.storeList.forEach(function(t){t.storeID===e.storeID&&t.proList.forEach(function(e){e.proID===n.proID&&(e.isFavourite=!1)})}),t.setState({})):Object(o.c)({\"title\":\"提示\",\"content\":a.data.msg,\"showCancel\":!1})})},t.handleComplete=function(){0!==t.countStore()&&t.complete()},t.complete=function(){var e=[];t.state.storeList.forEach(function(t){t.proList.forEach(function(t){if(!0===t.checked){var n={\"number\":t.amount_amount,\"shoppingDetailId\":t.id};e.push(n)}})});var n={\"shoppingDetailList\":e};t.gotoPageOrderSubmit(n)},t.gotoPageOrderSubmit=function(e){Object(h.a)(f.a.gotoSettlement,e).then(function(n){0===n.data.code?t.setState({\"pageSubmitInfo\":n.data.data},function(){window.sessionStorage.setItem(\"pageSubmitData\",JSON.stringify({\"pageSubmitInfo\":t.state.pageSubmitInfo,\"shoppingDetailList\":e.shoppingDetailList})),r.a.navigateTo({\"url\":\"../ordersubmit/ordersubmit\"})}):Object(o.d)({\"title\":n.data.msg,\"duration\":4e3,\"icon\":\"none\"})})},t.state={\"isEmpty\":!1,\"visibleOO\":!1,\"checkAll\":!0,\"totalAmount\":0,\"addressId\":3,\"pageSubmitInfo\":{},\"storeList\":[],\"checkedList\":[],\"hasCheckAll\":!0},t}return function _inherits(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{\"constructor\":{\"value\":e,\"enumerable\":!1,\"writable\":!0,\"configurable\":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Cart,r[\"a\"].Component),b(Cart,[{\"key\":\"componentDidMount\",\"value\":function componentDidMount(){Object(i.b)({\"title\":\"购物车\"})}},{\"key\":\"componentDidShow\",\"value\":function componentDidShow(){this.getCart()}},{\"key\":\"componentDidHide\",\"value\":function componentDidHide(){this.setState({\"storeList\":[]})}},{\"key\":\"render\",\"value\":function render(){var e=this;return a.l.createElement(c.a,{\"className\":\"cart\"},a.l.createElement(c.a,{\"className\":\"ct-Cart\"},a.l.createElement(\"form\",{\"action\":\"\"},a.l.createElement(s.a,{\"onChange\":this.handleCheckChange},a.l.createElement(c.a,{\"className\":\"table\"},a.l.createElement(l.a,{\"className\":\"checkAll_wrap\"},!0===this.state.hasCheckAll?a.l.createElement(u.a,{\"className\":\"checkbox checkAll\",\"onClick\":this.checkAll,\"checked\":this.state.checkAll},a.l.createElement(m.a,{\"className\":\"text\"},\"全选\")):null),this.state.storeList.map(function(t){return a.l.createElement(\"tbody\",{\"className\":\"tbody\",\"key\":t.storeID},a.l.createElement(\"tr\",{\"className\":\"tr storeName\"},a.l.createElement(\"td\",{\"className\":\"td\",\"colSpan\":\"2\"},a.l.createElement(m.a,{\"className\":\"text\"},t.storeName))),t.proList.map(function(n){return a.l.createElement(\"tr\",{\"className\":\"tr production\",\"key\":n.id},a.l.createElement(\"td\",{\"className\":\"td picture\"},a.l.createElement(u.a,{\"className\":\"checkbox\",\"name\":\"\",\"id\":\"\",\"checked\":!(!n.isShelfUp||n.expired)&&n.checked,\"onClick\":e.checkItem.bind(e,n,t),\"value\":n.id,\"disabled\":!n.isShelfUp||n.expired?\"disabled\":\"\"}),a.l.createElement(g.a,{\"url\":\"/pages/goodsdetails/goodsdetails?itemId=\"+n.proID},a.l.createElement(\"img\",{\"className\":\"img\",\"src\":n.img,\"alt\":\"\"}))),a.l.createElement(c.a,{\"className\":\"production_right\"},a.l.createElement(\"td\",{\"className\":\"td proInfo\"},a.l.createElement(g.a,{\"url\":\"/pages/goodsdetails/goodsdetails?itemId=\"+n.proID},n.proInfo,a.l.createElement(m.a,{\"className\":\"isShelfUp\",\"style\":{\"display\":!0!==n.isShelfUp?\"\":\"none\"}},\"（已下架）\"),a.l.createElement(m.a,{\"className\":\"expired\",\"style\":{\"display\":n.expired?\"\":\"none\"}},\"（已过期）\"))),a.l.createElement(\"td\",{\"className\":\"td proStyle\"},a.l.createElement(m.a,{\"className\":\"subType\"},n.subType),a.l.createElement(m.a,{\"className\":\"type\"},n.type),a.l.createElement(\"td\",{\"className\":\"td singlePrice\"},a.l.createElement(m.a,{\"className\":\"priceOrigin currency\",\"style\":{\"display\":n.originPrice!==n.singlePrice?\"\":\"none\"}},n.originPrice),a.l.createElement(m.a,{\"className\":\"priceCurrent currency\"},n.singlePrice)),a.l.createElement(c.a,{\"className\":\"amount\"},a.l.createElement(p.a,{\"className\":\"reduce\",\"type\":\"Button\",\"onClick\":e.amountReduce.bind(e,t,n)},a.l.createElement(m.a,{\"className\":\"line\"})),a.l.createElement(d.a,{\"type\":\"number\",\"className\":\"amount_amount\",\"value\":n.amount_amount,\"maxLength\":\"2\",\"min\":\"1\",\"onBlur\":function onBlur(a){e.inputComplete(a,t,n)}}),a.l.createElement(p.a,{\"className\":\"raise\",\"type\":\"Button\",\"onClick\":e.amountRaise.bind(e,t,n)},a.l.createElement(m.a,{\"className\":\"line\"}),a.l.createElement(m.a,{\"className\":\"line trans\"})))),a.l.createElement(\"td\",{\"className\":\"td action\"},a.l.createElement(p.a,{\"className\":\"delete\",\"type\":\"Button\",\"onClick\":e.deleteSingleConfirm.bind(e,t,n)},\"删除\"),a.l.createElement(p.a,{\"className\":\"concern\",\"type\":\"Button\",\"onClick\":e.handleConcern.bind(e,t,n),\"style\":{\"display\":!1===n.isFavourite?\"\":\"none\"}},\"添加收藏\"),a.l.createElement(p.a,{\"className\":\"isFavourite\",\"style\":{\"display\":!0===n.isFavourite?\"\":\"none\"},\"onClick\":e.handleCancelConcern.bind(e,t,n)},\"取消收藏\"))))}))})),a.l.createElement(c.a,{\"className\":\"empty\",\"style\":{\"display\":!0===this.state.isEmpty?\"block\":\"none\"}},\"空空如也~~快去选购您喜爱的商品吧\"),a.l.createElement(c.a,{\"className\":\"action_bottom\"},a.l.createElement(c.a,{\"className\":\"left\"}),a.l.createElement(c.a,{\"className\":\"right\"},a.l.createElement(c.a,{\"className\":\"totalAmount\"},a.l.createElement(m.a,{\"className\":\"description\"},\"（不含运费）\"),a.l.createElement(m.a,{\"className\":\"title\",\"decode\":\"{{true}}\"},\"总价:  \"),a.l.createElement(m.a,{\"className\":\"currency\"},this.state.totalAmount.toFixed(2))),a.l.createElement(p.a,{\"className\":\"complete\",\"onClick\":this.handleComplete,\"type\":\"Button\"},\"去结算\")))))),a.l.createElement(y.a,null))}}]),Cart}()},\"258\":function(e,t,n){}}]);","extractedComments":[]}